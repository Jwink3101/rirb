# Malware Protection

There are a few elements to using rclone/rirb that protect against malware.

## Non-Backup-aware Malware

This is the simplest! If the malware infects some files but not those needed to do a backup, when a backup happens, it will use a lot of space but all files will get moved to the backup.

If they infect but do not change size or ModTime then even better! The files will be in the original backup still.

## Backup-aware Malware

The more insidious malwares will actually target the backup. For this, I have a few mitigations. None 100% foolproof but with defense-in-depth, I feel pretty safe. Roughly in line:

1. This is not my sole backup! It is one of at least 2 but more likely 3,4,5+
1. **Encrypted rclone config**: My rclone configs are encrypted but I run a daemon to provide the password. So this is only useful if someone gets the files and not access to my running machine
1.  **Security through obscurity**: Never a good policy *alone* but the attacker would have to realize that my backups are through rclone/rirb and then issue `purge` or `delete` commands (or call the relevant API).
1. **Rely on the remote**: This really depends on your remote but nearly all offer some kind of backup/retention. I will only talk about the two I consider but others have similar features
	- *OneDrive*: There is no API call to delete the Recycle Bin and otherwise, I can restore files. PITA for sure but in an emergency, I can restore files as needed
	- *B2*: While B2 offers immutable objects, they will break the `--backup-dir` (or process with rirb) flow of moving (which is actually a copy+delete on B2) files when replacing them. Instead I rely on the built in versions **and** the fact that the only API key I have stored anywhere but my password manager (which also has an additional retype-password requirement for it) do not have the ability to `--b2-hard-delete` (or same API call). See [B2 Key that is safe](B2%20Key%20that%20is%20safe.md) for instructions
	    - *S3* probably has a similar mechanism though it may depend on the provider.
	- *Hetzner Storage Box* - Automated (ZFS?) Snapshots
    